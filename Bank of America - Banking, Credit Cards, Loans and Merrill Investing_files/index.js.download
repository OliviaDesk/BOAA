!function(){"use strict";var e;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&o.firstChild?o.insertBefore(i,o.firstChild):o.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}('.sparta-widget-loader-v6.sparta-widget-loading-spinner{position:relative;text-align:justify}.sparta-widget-loader-v6.sparta-widget-loading-spinner:before{animation:sparta-widget-loading-animation 2s linear infinite;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20xmlns:xlink=%22http://www.w3.org/1999/xlink%22%20x=%220%22%20y=%220%22%20width=%2224%22%20height=%2224%22%20viewBox=%220,0,24,24%22%3E%3Cpath%20fill=%22black%22%20stroke=%22%22%20stroke-width=%22%22%20style=%22%22%20d=%22M11.9117276,22 C7.06862372,22.0011298 2.90808187,18.5905839 2,13.8749998 L3.00882724,13.6899998 C3.90914096,18.3580403 8.31588698,21.5276214 13.0721202,20.9280896 C17.8283535,20.3285577 21.2945553,16.1665773 20.9875764,11.4237459 C20.6805974,6.6809145 16.7062561,2.99213104 11.9117276,3 L11.9117276,2 C17.4833266,2 22,6.47715244 22,12 C22,17.5228473 17.4833266,22 11.9117276,22 Z%22%20/%3E%3C/svg%3E");background-position:50%;background-repeat:no-repeat;background-size:48px;bottom:0;content:" ";height:48px;left:50%;margin:auto auto auto -24px;position:absolute;top:0;width:48px;z-index:1}.sparta-widget-loader-v6 [data-sparta-container].sparta-widget-loading{height:100%;text-align:justify;width:100%}.sparta-widget-loader-v6 [data-sparta-container].sparta-widget-loading>.sparta-widget{height:100%;visibility:hidden}@keyframes sparta-widget-loading-animation{to{transform:rotate(1turn)}}'),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),o=1;o<arguments.length;o++){var i=arguments[o];if(null!=i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},writable:!0,configurable:!0}),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return void 0===t&&(t=0),-1!==this.indexOf(e,t)}),String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return"[object regexp]"===Object.prototype.toString.call(e).toLowerCase()?this.replace(e,t):this.replace(new RegExp(e,"g"),t)}),"function"!=typeof Promise&&(window,e=function(){function e(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))}var n=setTimeout;function o(e){return Boolean(e&&void 0!==e.length)}function i(){}function r(e){if(!(this instanceof r))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(e,this)}function a(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,r._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var o;try{o=n(e._value)}catch(e){return void c(t.promise,e)}s(t.promise,o)}else(1===e._state?s:c)(t.promise,e._value)}))):e._deferreds.push(t)}function s(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===t(n)||"function"==typeof n)){var o=n.then;if(n instanceof r)return e._state=3,e._value=n,void d(e);if("function"==typeof o)return void u((i=o,a=n,function(){i.apply(a,arguments)}),e)}e._state=1,e._value=n,d(e)}catch(t){c(e,t)}var i,a}function c(e,t){e._state=2,e._value=t,d(e)}function d(e){2===e._state&&0===e._deferreds.length&&r._immediateFn((function(){e._handled||r._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function l(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function u(e,t){var n=!1;try{e((function(e){n||(n=!0,s(t,e))}),(function(e){n||(n=!0,c(t,e))}))}catch(e){if(n)return;n=!0,c(t,e)}}r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var n=new this.constructor(i);return a(this,new l(e,t,n)),n},r.prototype.finally=e,r.all=function(e){return new r((function(n,i){if(!o(e))return i(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return n([]);var a=r.length;function s(e,o){try{if(o&&("object"===t(o)||"function"==typeof o)){var c=o.then;if("function"==typeof c)return void c.call(o,(function(t){s(e,t)}),i)}r[e]=o,0==--a&&n(r)}catch(e){i(e)}}for(var c=0;c<r.length;c++)s(c,r[c])}))},r.resolve=function(e){return e&&"object"===t(e)&&e.constructor===r?e:new r((function(t){t(e)}))},r.reject=function(e){return new r((function(t,n){n(e)}))},r.race=function(e){return new r((function(t,n){if(!o(e))return n(new TypeError("Promise.race accepts an array"));for(var i=0,a=e.length;i<a;i++)r.resolve(e[i]).then(t,n)}))},r._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){n(e,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var f=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();"Promise"in f?f.Promise.prototype.finally||(f.Promise.prototype.finally=e):f.Promise=r},"object"===("undefined"==typeof exports?"undefined":t(exports))&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e());const n="6.0.5".split("-")[0];!function(){if(window.sparta=window.sparta||{},sparta.widgetLoader=sparta.widgetLoader||{},sparta.widgetLoader[n])return void console.log(`Widget lodaer version "${n}" already loaded`);const e={},t={},o={},i=e=>!!document.getElementById(e),r=e=>e.id=e.id||`id${(new Date).getTime()}`,a=(e,t)=>`${e}-${t}`,s=e=>"string"==typeof e?i(e)?e:o[e]:e.id;if("function"!=typeof window.CustomEvent){function y(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}y.prototype=window.Event.prototype,window.CustomEvent=y}function c(e){if("string"==typeof e){const t=i(e)?`#${e}`:e,n=t,a=t==e;if(1!==document.querySelectorAll(t).length)throw new Error("A single element is required as a container.");return e=document.querySelector(t),r(e),a&&!o[n]&&(o[n]=e.id),e}if("object"==typeof e&&e.nodeType)return r(e),e;throw new Error("A valid DOM Id, selector or DOM Node must be passed as a container.")}function d(e){try{const{name:n,version:o}=t[e],i=window.spaWidgetParams[n][o].getBootstrapUtilityInstance(),{moduleInstances:r,initedModules:a}=i;for(const t in r)r[t]=r[t].filter(((n,o)=>{if(!(n.id===e||n.widgetInfo&&n.widgetInfo.id===e))return!0;r[t][o].destroy&&r[t][o].destroy(),delete r[t][o]}));i.initedModules=a.filter(((t,n)=>{if(t&&t.module.widgetInfo){if(t.module.widgetInfo.id!==e)return!0;delete a[n]}}));const s=t[e].spartaEvents;s&&s.unsubByEventNamePattern&&s.unsubByEventNamePattern(`_${e}`),t[e].destroy&&t[e].destroy(),document.getElementById(e).innerHTML="",delete t[e]}catch(t){return console.error("Destroying widget instance failed for Widget.",e),!1}return!0}function l({container:e}){const t=e.querySelector("[data-sparta-container]");t&&(t.style.visibility="visible",t.classList.remove("sparta-widget-loading")),e.style.visibility="visible",e.classList.remove("sparta-widget-loading"),e.classList.remove("sparta-widget-loading-spinner")}async function u({container:t,path:n,name:o,version:i,id:r,options:s,language:c="en",spinner:d=!0}){!function({container:e,spinner:t}){e.classList.add("sparta-widget-loader-v6"),e.classList.add("sparta-widget-loading"),t&&e.classList.add("sparta-widget-loading-spinner")}({container:t,spinner:d});const l=a(o,i);e[l]=e[l]||{};let{loaderPromise:u}=e[l];if(u)console.log("Using cache widget details");else{let r,a;u=e[l].loaderPromise=new Promise(((e,t)=>{[r,a]=[e,t]}));const d=new XMLHttpRequest;s.withoutCredentials||(d.withCredentials=!0);const f=c&&"en"!==c.toLowerCase()?`/${c.toLowerCase()}`:"",p=`${n}/spa/widgets/${o}/${i}${f}/index.html`;d.open("GET",p),d.onreadystatechange=function(){if(4===d.readyState)if(d.status<200||d.status>=300)s.onError&&s.onError({widget:{name:o,version:i,path:n,container:t}}),delete e[l],a({status:d.status,statusText:`Unable to load widget: ${p} - ${d.statusText}`});else{const e=function(e){const t=document.createElement("div");t.innerHTML=e;const n=t.querySelectorAll("link"),o=t.querySelectorAll("script");let i=[],r=[];n&&Array.prototype.forEach.call(n,(e=>{i.push({href:e.href}),e.parentNode.removeChild(e)}));o&&Array.prototype.forEach.call(o,(e=>{const t={};Array.prototype.forEach.call(e.attributes,(e=>{t[e.name]=e.value}));const{src:n,innerText:o}=e;r.push(n?{src:n,attrs:t}:{text:o,attrs:t}),e.parentNode.removeChild(e)}));const a=t.querySelector("#asset-urls-container"),s=JSON.parse(a.innerText);a.parentNode.removeChild(a),i=s.css.map((e=>({href:e}))).concat(i);const c=!!window.MSInputMethodContext&&!!document.documentMode;return s.scripts.forEach((e=>{c?-1===e.indexOf("-es6-")&&r.push({src:e}):-1===e.indexOf("-es5-")&&r.push({src:e})})),{css:i,scripts:r,html:t.innerHTML}}(d.responseText);r({widgetData:e})}},d.send()}return u}function f({name:t,version:n,id:o,container:i,widgetData:r}){return new Promise(((s,c)=>{const d=a(t,n);if(e[d].scriptsLoaded)return s();r.scripts.reduce(((e,r)=>e.then((()=>function({script:e,container:t,name:n,version:o,id:i}){return new Promise(((r,a)=>{const s=document.createElement("script");if(e.attrs)for(const t in e.attrs)s.setAttribute(t,e.attrs[t]);s.setAttribute("widget-name",n),s.setAttribute("widget-version",o),s.setAttribute("widget-id",i),e.text?s.appendChild(document.createTextNode(e.text)):(s.src=e.src,s.onload=()=>r(!0),s.onerror=t=>a(`Failed to load the widget script - ${e.src}. ${t}`)),t.appendChild(s),e.text&&r(!0)}))}({script:r,container:i,name:t,version:n,id:o})))),Promise.resolve()).then((()=>{e[d].scriptsLoaded=!0,s()})).catch((e=>{console.error("Loading widget scripts failed."),c(e)}))}))}function p({name:t,version:n,widgetData:o}){return new Promise(((i,r)=>{const s=a(t,n);if(e[s].cssLoaded)return i();o.css.reduce(((e,t)=>e.then((()=>function({href:e}){return new Promise(((t,n)=>{const o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.onload=()=>t(e),o.onerror=t=>n(`Failed to load the widget css - ${e}. ${t}`),o.href=e,document.head.appendChild(o)}))}(t)))),Promise.resolve()).then((()=>{e[s].cssLoaded=!0,i()})).catch((e=>{console.error("Loading widget css failed."),r(e)}))}))}function g({id:e,container:n}){t[e]={},t[e].events=function({container:e}){return Object.create({eventCollection:[],pub(t,n={}){if(!n.widget||n.widget.id===e.id){const o=new CustomEvent(t,{detail:n});e.dispatchEvent(o)}},sub(t,n){this.eventCollection.push({type:"widget",name:t,fn:n}),e.addEventListener(t,n)},unsub(t,n){e.removeEventListener(t,n)},once(t,n){const o=i=>{e.removeEventListener(t,o),n(i)};e.addEventListener(t,o)}})}({container:n}),t[e].hideLoading=()=>{l({container:n})}}async function h({name:e,version:o,container:i,options:r={},path:a}){const s=window.spaWidgetParams[e][o],c=s.getBootstrapUtilityInstance(),{id:d}=i;return s[d]={...s},g({id:d,container:i}),function({id:e,singletonUtiiltiyInitializers:t}){t.forEach((t=>{try{t({widgetId:e})}catch(e){}}))}({id:d,singletonUtiiltiyInitializers:s.singletonUtiiltiyInitializers||[]}),await c.init({name:e,version:o,id:d,options:r,loaderVersion:n,widgetApiEndpoint:a}),function({container:e,spartaBootstrapUtilityInstance:n}){const{id:o}=e,i=e.querySelector('[data-component="module"]').getAttribute("data-init"),r=n.moduleInstances[i].find((e=>e.id===o));return r.events=t[o].events,r.hideLoading=t[o].hideLoading,t[o]=r,r}({container:i,spartaBootstrapUtilityInstance:c})}sparta.widgetLoader[n]={load:async e=>{try{const{container:n,options:o={}}=e,{id:i}=e.container=c(n);if(t[i]){if(o.reuseInstance)return t[i].spartaEvents.pub("REUSING_WIDGET_INSTANCE",t[i],{id:i}),void console.log("Reusing current widget instance");d(i)}const r=await u(e);if(await async function(e,t){const{name:n,version:o,container:i,options:r}=e,{widgetData:a}=t;return i.innerHTML=a.html,i.style.height="auto",i.style.backgroundImage="",i.querySelector("[data-sparta-wrapper]").classList.add(`${n}-${o.replace(/\./g,"-")}`),i.querySelector("[data-sparta-widget]").setAttribute("data-sparta-options",JSON.stringify(r)),Promise.all([p({name:n,version:o,widgetData:a}),f({name:n,version:o,container:i,widgetData:a,id:i.id})])}(e,r),await h(e),"function"==typeof o.onLoad)try{o.onLoad(t[i])}catch(e){console.error("Exception occurred in the onLoad callback")}}catch(t){console.error("Error in loading the widget",t),"string"!=typeof e.container&&(e.container.innerHTML="<p>Unable to load widget.</p>",l({container:e.container}))}},destroy:e=>{try{if(e){const n=s(e);if(t[n])return d(n)}}catch(e){}return!1},getInstance:e=>{try{if(e){const n=s(e);return t[n]||null}}catch(e){}return null},refresh:({container:e,options:n={}})=>{const{id:o}=c(e);t[o]?t[o].spartaEvents.pub("REFRESH_WIDGET",{data:n},{id:o}):console.error("Widget doesn't exist")}}}(),sparta.widgetLoader[n]}();
